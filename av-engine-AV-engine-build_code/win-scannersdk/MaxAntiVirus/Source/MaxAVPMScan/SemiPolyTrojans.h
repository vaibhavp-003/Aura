/*======================================================================================
FILE				: SemiPolyTrojans.h
ABSTRACT			: Part of AuAVPMScan.dll module.
DOCUMENTS			: 
AUTHOR				: Tushar Kadam + Virus Analysis Team
COMPANY				: Aura 
COPYRIGHT NOTICE	: (C) Aura
					Created as an unpublished copyright work.  All rights reserved.
					This document and the information it contains is confidential and
					proprietary to Aura.  Hence, it may not be 
					used, copied, reproduced, transmitted, or stored in any form or by any 
					means, electronic, recording, photocopying, mechanical or otherwise, 
					without the prior written permission of Aura
CREATION DATE		: 22 Apr 2011
NOTES				: This is detection module for malware using * base detection pattern.
					  Aho-corasick binary seraching is used to fasten the detection 
					  Boyer-moor algo is used for single pattern
					  It is the collection of different malwares for which we use Aho-corasick
					  Class is derived from CPolyBase Class
					  The repair action is : DELETE or REPAIR
VERSION HISTORY		: 
=====================================================================================*/
#pragma once
#include "polybase.h"

class CSemiPolyTrojans : public CPolyBase
{
	int		DetectTrojanCommon();

	int		DetectOnlineGames();
	int		DetectScreensaver();
	int		DetectTrojanScar();
	int		DetectDelf();
	int		DetectLLAC();
	int		DetectStartPageM();
	int		DetectRefroso();
	int		DetectDybalom();
	int		DetectSwisyn();
	int		DetectArchSMS();
	int		DetectAutoRun();
	int		DetectKapucenB();
	int		DetectSahatG();
	int		DetectAgentCP();
	int		DetectCinmus();
	int		DetectRbotHyj();
	int		DetectTentRootkit();
	int		DetectSecurityShield();
	int		DetectHIGEN();
	int		DetectTrojanBHO();
	int		DetectiBryteX();
	int		DetectProrat();
	int		DetectAgentSdpu();
	int		DetectMultplugA();
	int		DetectMSILPetunA();
	int		DetectArtuaVladislav();
	int		DetectAgentDywo();
	int		DetectVBca();
	int		DetectWormJuched();
	int		DetectSmartFake();
	int		DetectDownloaderGaur();
	int		DetectEorezoGP();
	int		DetectFujackAA();
	int		DetectAgentBPXO();
	int		DetectSpySCKeyLog();
	int		DetectKoutodoorAIHC();
	int		DetectTepfer();
	int		DetectAvalod();
	int		DetectJorikSkor();
	int		DetectAgentGUPX();
	int		DetectGameVance();
	int		DetectClickRun();
	int		DetectAgentBJEV();
	int		DetectBHOBENF();
	int		DetectAgentAirs();
	int		DetectPWSOnlineGames();
	int		DetectDropperDecayFVR();
	int		DetectCodecPackAFBF();
	int		DetectSmallBrus();
	int		DetectSpyKeyloggerQZP();
	int		DetectMahato();
	int		DetectBackdoorRipinipOTB();
	int		DetectZhelatinvg();
	int		DetectDropperInegeryCQ();
	int		DetectDarkComet();
	int		DetectDialerSmallE();
	int		DetectClickerAutoItO();
	int		DetectAgentDJ();
	int		DetectAdwareLook2MeAB();
	int		DetectBackdoorAgentBULO();
	int		DetectScarEXXU();
	int		DetectBackdoorXtremeAZC();
	int		DetectBackdoorVBLVN();
	int		DetectAgentSXPQ();
	int		DetectKillav();
	int		DetectVBNA();
	int		DetectArdamax();
	int		DetectBrontok();
	int		DetectPSWAccPhishEU();
	int		DetectBackdoorAgentBYKX();
	int		DetectMapler();
	int		DetectDialerQN();
	int		DetectBybz();
	int		DetectPalevo();
	int		DetectSmall_EDB();
	int		DetectNrgBot();
	int		DetectTrojanVBEZU();
	int		DetectAgentEVQG();
	int		DetectZopfodA();
	int		DetectLoadwar();
	int		DetectBackdoorXtremeA();
	int		DetectTrojanMicroFakeBA();
	int		DetectAgentCbot();
	int		DetectAdwareFlvTubeBT();
	int		DetectBancos();
	int		DetectPinballCorporation();
	int		DetectIRCNite();
	int		DetectFosniw();
	int		DetectCodraEQM();
	int		DetectAgentAJV();
	int		DetectAzbregPYV();
	int		DetectAdloadAQDQ();
	int		DetectDownloaderAgentEDBQ();
	int		DetectDropperAgentBCZN();
	int		DetectKnigsfot();
	int		DetectAgentAzCj();
	int		DetectPlaygameA();
	int		DetectAgentACW();
	int		DetectTrojanAgent2LDT();
	int		DetectBeastdoorL();
	int		DetectBinderRz();
	int		DetectDipleDmqa();
	int		DetectFraudPackCpMz();
	int		DetectNilageBXY();
	int		DetectDropAgentAyqa();
	int		DetectAgentLTA();
	int		DetectGamupFR();
	int		DetectPakesTyi();
	int		DetectRansomBlockerJGB();
	int		DetectIRCNiteCBV();
	int		DetectScarEAML();
	int		DetectDrpAgentEMLQ();
	int		DetectBackDooorCZP();
	int		DetectStudALB();
	int		DetectDownloaderAndromedaEBJ();
	int		DetectClickerCyclerAJSZ();
	int		DetectJorikVobfusCqaz();
	int		DetectAutorunCxps();
	int		DetectAgentRzr();
	int		DetectGameThiefMaganiaBIHT();
	int		DetectDeeceeG();
	int		DetectTrojanMalwareBSM();
	int		DetectUrelas();
	int		DetectCoolMirageLtd();
	int		DetectIRCmirc603();
	int		DetectQhostsAF();
	int		DetectQhost();
	int		DetectAirInstaller();
	int		DetectDebris();
	int		Detect4Shared();
	int		DetectDelfDuy();
	int		DetectDropperMetalA();
	int		DetectWormBundpil();
	int		DetectSinowalORC();
	int		DetectWormBenjaminA();
	int		DetectBackdoorDonbotB();
	int		DetectBackdoorAgentUEK();
	int		DetectBackdoorFinloskyB();
	int		DetectChydoAXA();
	int		DetectPalevoCqmm();
	int		DetectDownloaderLMN();
	int		DetectInstallBrain();
	int		DetectAdloadU();
	int		DetectObfuscatedFEQ();
	int		DetectDragonMess();
	int		DetectWinper();
	int		DetectInjectZZX();
	int		DetectWebtoolbarMyWebSearch();
	int		DetectJorikFareitQsy();
	int		DetectJorikWanbagEM();
	int		DetectVBAso();
	int		DetectQukartGen();
	int		DetectHotKeyHook();
	int		DetectPowpGen();
	//int		DetectGameThiefLmirWJ();
	int		DetectPePatchedLX();
	int		DetectAgentSn();
	int		DetectTrojanFakeAVASBH();
	int		DetectPSWLdPinchDLT();
	int		DetectPSWOnLineGamesGen();
	int		DetectIndirectA();
	int		DetectMegaSearch();
	int		DetectAgentFO();
	int		DetectAgentAYUW();
	int		DetectIRCBotAerz();
	int		DetectInjectorHXBU();
	int		DetectDangloKT();
	int		DetectDomaIQ();
	int		DecteAgentAl();
	int		DetectDownloadSponsor();
	int		DetectDdoxCJN();
	int		DetectCertificate(); 
	int		DetectAbuseMx();
	int		DetectKeyLogger();
	int		DetectLolipop();
	int		DetectVanBot();
	int		DetectWebprefixApj();
	int		DetectStagetEg();
	int		DetectBanker();
	int		DetectSmallo();
	int		DetectZenoSearch();
	int		DetectOficla();
	int		DetectSocks();
	int		DetectTrojanBuzus();
	int		DetectAgentBcw();
	int		DetectBlueHeaven();
	int		DetectAgentdele();
	int		DetectClickerAgent();
	int		DetectDownloaderCeed();
	int		DetectReconycBvep();
	int		DetectHacktoolAgentape();
	int		DetectBuzusFvjf();
	int		DetectInjectorHxth();
	int		DetectDownloaderMorstarAs();
	int		DetectDropperhkve();
	int		DetectMultiplagB();
	int		DetectAgenthedm();
	int		DetectJuchedPgy();
	int		DetectYotoonBFM();
	int		DetectChydoCCQ();
	int		DetectAirAdInstallerGacx();
	int		DetectGenomeAdbwg();
	int		DetectMultiPlugL();
	int		DetectAgentahruw();
	int		DetectBadurjukw();
	int		DetectDropperSmall();
	int		DetectMultiPlugNbld();
	int		DetectLollipopMv();
	int		DetectDelfgk();
	int		DetectWenper();
	int		DetectSmartInstallerA();
	int		DetectClickerKuk();
	int		DetectLolbot();
	int		DetectDorifel();
	int		DetectAgentJKOA();
	int		DetectTenta();
	int		DetectBackdoorZegostAIKW();
	int		DetectPlocustJCMB();
	int		DetectDomaIQBtzf();
	int		DetectLMNMldc();
	int		DetectFareitApfz();
	int		DetectKranetC();
	int		DetectBagleAf();
	int		DetectBdmj();
	int		DetectPlocust();
	int		DetectAutoRunBANT();
	int		DetectCryptPIA();
	int		DetectLinkuryA();
	int		DetectScarEXWW();
	int		DetectMydoomM();
	int		DetectSelfDeltke();
	int		DetectIbryteJhl();
	int		DetectCosmuCbyn();
	int		DetectBublik();
	int		DetectZusy();
	int		DetectClickerSmallAK();
	int		DetectDroppernekl();
	int		DetectNvxg();
	int		DetectHedxp();
	int		DetectBrainInst();
	int		DetectShipupBoe();
	int		DetectAgentN();
	int		DetectLargeFiles();
	int		DetectAgentUWUE();
	int		DetectDriverUPD();
	int		DetectRansomBlockerMGN();
	int		DetectMydoomL();
	int		DetectRansomBlockerGFEQ();
	int		DetectFiseriaHV();
	int		DetectYotoonSZT();
	int		DetectDapatoEdqu();
	int		DetectBaduramrst();
	int		DetectAgentXknn();
	int		DetectAgentUggl();
	int		DetectPlocustFzpb();
	int		DetectPlocustGlbw();
	int		DetectPlocustGmby();
	int		DetectDriverUpd();
	int		DetectBackdoorZepfod();
	int		DetectWormSohanad();
	int		DetectScarOich();
	int		DetectPliteBhst();
	int		DetectWecodAll();
	int		DetectZepfodYY();
	int		DetectUpatreDmid();
	int		DetectUpatre();
	int		DetectSmallCpl();
	int		DetectArdurkG();
	int		DetectUpatreSby();
	int		DetectJSMultiplugP();
	int		DetectInjectUezn();
	int		DetectRootkitegxj();
	int		DetectTrojanAcqad();
	int		DetectSoftplusXsw();
	int		DetectDownBVTD();
	//int		DetectDownHFDG();
	int		DetectWormBloored();
	int		DetectAgentB();
	int		DetectUpatreBkvd();
	int		DetectAdLoadGen();
	int		DetectShizEuxx();
	int		DetectImaliC();
	int		DetectDownloadmin();
	int		DetectMorstarEWI();
	int		DetectWormNgrbotOu();
	int		DetectCabresA();
	int		DetectWebToolbarLinkury();
	int		DetectAdwAgentJTVG();
	int		DetectDownMorstarBFT();
	int		DetectDownLmnAEV();
	int		DetectVbCUVT();
	int		DetectCosmuAIGH();
	int		DetectScarOetk();
	int		DetectWebToolbarCossder();
	int		DetectBackdoorSena();
	int		DetectInjectAfhey();
	int		DetectTrojGenB();
	int		DetectDLBoost();
	int		DetectDropperTDSS();
	int		DetectRazy();
	int		DetectFenomenGame();
	int		DetectAgentKDEA();
	int		DetectLinkuryBD();
	int		DetectMorstarAS();
	int		DetectOutBrowseBU();
	int		DetectRootkitBSE();
	int		DetectRootkitVkd();
	int		DetectAgentbBQAF();
	int		DetectBadurJISX();
	int		DetectCosmuDHRW();
	int		DetectCryptEUQ();
	int		DetectScarOetr();
	int		DetectDownloaderAX();
	int		DetectTrojRazy91846();
	int		DetectDownDriverUpdAYVN();
	int		DetectTrojRAZY71851();
	int		DetectRansomeBlockerOOEW();
	int		DetectdWbtlbrDownloaderPGA();
	int		DetectTrojanRazy9138();
	int		DetectBankerSHIFU();
	int		DetectTrojanDropperEB();
	int		DetectVBZtl();
	int		DetectTAgentIGRH();
	int		DetectAdwareZugoO();
	int		DetectMP3EXT();
	int		DetectDropperInjectotJKSA();
	int		DetectSpyQQLogger();
	int		DetectAdwareELEX();
	int		DetectSelfDelASBD();
	int		DetectAgentSILTZR();
	int		DetectIRCbotGEN();
	int		DetectClickerGEN();
	int		DetectCrabRansom();
	int		DetectAdwareBrowsefox10();
	int		DetectAdwareBrowsefoxFY();
	int		DetectAdwareBrowsefoxGE();
	int		DetectTrojanjpai();
	int		DetectTrojanScarOjsz();
	int		DetectTrojanSelfDeldpaj();
	int		DetectTrojanSelfDelesqg();
	int		DetectAdwareAmontize();
	int		DetectDownloadSponsorPE();
	//int		DetectDownloaderAgent();
	int		DetectMSILDkmz();
	int		DetectWindefAAQA();
	int		DetectWormCAC();
	int		DetectPalevoHZDG();
	int		DetectPackedKrapJC();
	int		DetectCrabRansomGandCryptJZ();
	int		DetectPackedUpantrixGen();
	int		DetectWormNgrbotDHX();
	int		DetectAdposhel_C();
	int		DetectPondFullA();
	int		DetectTrojRanBlockerKPUO();
	int		DetectUpatreGen();
	int		DetectCosstaSHU();
	int		DetectBackdoorPliteBHSY();
	int		DetectPackedCrapJD();
	int		DetectRansomGandCrab();
	int		DetectRansomXorist();
	int		DetectTrojanClickerCNGJ();
	int		DetectCrabRansomGandCryptGen();
	int		DetectKryptikDL();
	int		DetectRansomChapak();
	int		DetectTrojanUrsu();
	int		DetectStartSurfGEN();	
	int		DetectBackGbotANWY();
	int		DetectDropper();
	int		DetectDownAdGazele();
	int		DetectCryptoLockerDY();
	int		DetectGlomaruA();
	int		DetectPackedKrapO();
	int		DetectDropperRSJ();
	int		DetectGenerickd();
	int		DetectSalgoreaB();
	int		DetectEmotetBankerGen();
	int		DetectNakuraA();
	int		DetectBankerEmotetSB();
	int		DetectChapakBNBM();
	int		DetectTrojanReconycFXMS();
	int		DetectFearsoB();
	int		DetectAdWareStartSurf();
	int		DetectWORMBAGLEZ();
	int		DetectApplicationBundleiStartSurfAEO();
	int		DetectBackdoorPaddorGen();
	int		DetectAgentdjcr();
	int		Detectcerbu25355();
	int		DetectGenericKDZ51306();
	int		DetectMSILGEN();
	int		DetectDownloaderNSISHafengen();
	int		DetectWormZafiB();
	int		DetectUpatreA();
	int		DetectDostreA();
	int		DetectMinerGen();
	int		DetectLamerEL();
	int		DetectChapakCNYR();
	int		DetectTrojanFsysna();
	int		DetectTrojanSlugin();
	int		DetectSmallX();
	int		DetectVBKM();
	int		DetectVBM();
	int		DetectVBJW();
	int		DetectBankerTricksterEKD();
	int		DetectBrontokN();


	int		DetectTrojanCurruptedFile();

	

	bool	FindResorce(int dwBuffSize, bool bCheckID = false);
	DWORD	NormalizeBuffer(LPBYTE byBuffer, DWORD cbBuffer);
	int		IsDropperAgentBPXO(); 
	int		IsSpyAgentBPXO();
	bool	IsGameVanceFile(DWORD dwCallOffSet);
	int		FindRes(LPCTSTR lpstNameID, LPCTSTR lpstLaunguage, LPCTSTR lpstLangID, DWORD &dwRVA, DWORD &dwSize);
	bool	CheckDarkComet(DWORD dwSigOffset1, DWORD dwSigOffset2, DWORD dwSigOffset3);
	bool	CheckForVBFiles();
	bool	CheckFosniwSig(DWORD dwDecOffset,BYTE byKey);

public:
	CSemiPolyTrojans(CMaxPEFile *pMaxPEFile);
	~CSemiPolyTrojans(void);
	
	int		DetectVirus();
	TCHAR	m_szSysDrive[MAX_PATH];

	int		DetectWhiteCertificateEx();
	int		DetectWhiteCertificate();
};

